{"ast":null,"code":"var _jsxFileName = \"/Users/zoemeng/zoe/learn/jianshu_project/client/src/common/header/index.js\";\nimport React, { Component } from 'react'; // 如果JSX 想要正常编译，必须用这个\n\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { CSSTransition } from 'react-transition-group';\nimport { actionCreator } from './store';\nimport { actionCreator as actionCreatorLogin } from '../../pages/login/store';\nimport { HeaderWrapper, Logo, Nav, SearchInfo, SearchInfoTitle, SearchInfoUpdate, SearchInfoItem, SearchInfoList, NavItem, NavSearch, Button, SearchWrapper } from './style';\n\nclass Header extends Component {\n  getSearchInfoList() {\n    //结构赋值语法\n    const {\n      mouseIn,\n      focused,\n      list,\n      page,\n      totalPage,\n      handleMouseEnter,\n      handleMouseLeave,\n      handleUpdateContent\n    } = this.props; //list 是immutable\n\n    const pageList = [];\n    const newList = list.toJS(); //把immutable 数组转成一个普通的js数组\n    //ajax请求，如果newList 里面有东西的时候，newList才能作为key 值来使用 刚开始如果不做循环，那么Key 值就不会有任何的问题\n\n    if (newList.length) {\n      for (let i = (page - 1) * 10; i < page * 10; i++) {\n        pageList.push( /*#__PURE__*/React.createElement(SearchInfoItem, {\n          key: newList[i],\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 34,\n            columnNumber: 13\n          }\n        }, \" \", newList[i]));\n      }\n    } //在info 框里点击的时候也一样会显示\n\n\n    if (focused || mouseIn) {\n      return /*#__PURE__*/React.createElement(SearchInfo, {\n        onMouseEnter: handleMouseEnter,\n        onMouseLeave: handleMouseLeave,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(SearchInfoTitle, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 9\n        }\n      }, \"Hot Search\", /*#__PURE__*/React.createElement(SearchInfoUpdate, {\n        onClick: () => handleUpdateContent(page, totalPage, this.spinIcon),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        ref: icon => {\n          this.spinIcon = icon;\n        },\n        className: \"iconfont spin\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 11\n        }\n      }, \"\\uE65E\"), \"Update\")), /*#__PURE__*/React.createElement(SearchInfoList, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 9\n        }\n      }, pageList));\n    } else {\n      return null;\n    }\n  }\n\n  render() {\n    const {\n      focused,\n      handleInputFocus,\n      handleInputBlur,\n      list,\n      login,\n      logout\n    } = this.props;\n    return /*#__PURE__*/React.createElement(HeaderWrapper, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: \"/\",\n      className: \"logoWrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Logo, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(Nav, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(NavItem, {\n      className: \"left active\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 13\n      }\n    }, \"Home\"), /*#__PURE__*/React.createElement(NavItem, {\n      className: \"left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 13\n      }\n    }, \"Download App\"), /*#__PURE__*/React.createElement(SearchWrapper, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CSSTransition //控制出场动画\n    , {\n      in: focused //动画时长\n      ,\n      timeout: 200,\n      classNames: \"slide\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(NavSearch, {\n      className: focused ? 'focused' : '',\n      onFocus: () => handleInputFocus(list),\n      onBlur: handleInputBlur,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      className: focused ? 'focused iconfont zoom' : 'iconfont zoom',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, \"\\uE60C\"), this.getSearchInfoList()), /*#__PURE__*/React.createElement(Link, {\n      to: \"/write\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"reg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"iconfont\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 15\n      }\n    }, \"\\uE678\"), \"Add Article\")), /*#__PURE__*/React.createElement(Link, {\n      to: \"/register\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"write\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 15\n      }\n    }, \"Sign up\")), login ? /*#__PURE__*/React.createElement(NavItem, {\n      onClick: logout,\n      className: \"right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 15\n      }\n    }, \"Log out\") : /*#__PURE__*/React.createElement(Link, {\n      to: \"/login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(NavItem, {\n      className: \"right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 35\n      }\n    }, \"Log in\")), /*#__PURE__*/React.createElement(NavItem, {\n      className: \"right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"iconfont\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }\n    }, \"\\uE771\"))));\n  }\n\n} // Header 为statelss（无状态） 组件\n//好处：提高性能\n// 这个组件和store做连接的时候，store里的数据如何隐射到Props中去\n//state 指的是 store 里的所有数据\n//指的是仓库里的focused\n//加了header是因\b为放在了header里了。\n// getIn: 取header下面的focused 这个值\n// focused:state.get('header').get('focused') \n\n\nconst mapStateToProps = state => {\n  return {\n    focused: state.getIn(['header', 'focused']),\n    list: state.getIn(['header', 'list']),\n    page: state.getIn(['header', 'page']),\n    totalPage: state.getIn(['header', 'totalPage']),\n    mouseIn: state.getIn(['header', 'mouseIn']),\n    login: state.getIn(['login', 'login'])\n  };\n}; //组件在和store做连接的时候，当组件想要改变store里的内容，就要调用store里的方法 “mapDispathToProps” 写在这个方法里\n// dispatch : store.dispatch\n\n\nconst mapDispathToProps = dispatch => {\n  return {\n    handleInputFocus(list) {\n      list.size === 0 && dispatch(actionCreator.getList()); //\n      // const action = actionCreator.searchFocus();\n      //size from console 上的list的属性\n      // console.log(list)\n      // if(list.size === 0){\n      //   dispathch(actionCreator.getList());\n      // }\n\n      dispatch(actionCreator.searchFocus());\n    },\n\n    handleInputBlur() {\n      // const action = actionCreator.searchBlur()\n      dispatch(actionCreator.searchBlur());\n    },\n\n    handleMouseEnter() {\n      dispatch(actionCreator.mouseEnter());\n    },\n\n    handleMouseLeave() {\n      dispatch(actionCreator.mouseLeave());\n    },\n\n    handleUpdateContent(page, totalPage, spin) {\n      let oriDeg = spin.style.transform.replace(/[^0-9]/ig, ''); //如果这里面的内容都不是0-9的数字，那就替换成空\n      // console.log(oriDeg);\n\n      if (oriDeg) {\n        oriDeg = parseInt(oriDeg, 10); // 以10进制的方式转换为一个正整数 \n      } else {\n        oriDeg = 0; //第一次点击\n      }\n\n      spin.style.transform = 'rotate(' + (oriDeg + 360) + 'deg)'; // spin.style.transform = 'rotate(' + (oriDeg + 360) + 'deg)';\n\n      if (page < totalPage) {\n        dispatch(actionCreator.updateContent(page + 1));\n      } else {\n        // 如果在最后一页面上了，再回到第一页面 if(page == totalPage)\n        dispatch(actionCreator.updateContent(1));\n      } // console.log(page,totalPage)\n\n    },\n\n    logout() {\n      dispatch(actionCreatorLogin.logout());\n    }\n\n  };\n};\n\nexport default connect(mapStateToProps, mapDispathToProps)(Header);","map":{"version":3,"sources":["/Users/zoemeng/zoe/learn/jianshu_project/client/src/common/header/index.js"],"names":["React","Component","connect","Link","CSSTransition","actionCreator","actionCreatorLogin","HeaderWrapper","Logo","Nav","SearchInfo","SearchInfoTitle","SearchInfoUpdate","SearchInfoItem","SearchInfoList","NavItem","NavSearch","Button","SearchWrapper","Header","getSearchInfoList","mouseIn","focused","list","page","totalPage","handleMouseEnter","handleMouseLeave","handleUpdateContent","props","pageList","newList","toJS","length","i","push","spinIcon","icon","render","handleInputFocus","handleInputBlur","login","logout","mapStateToProps","state","getIn","mapDispathToProps","dispatch","size","getList","searchFocus","searchBlur","mouseEnter","mouseLeave","spin","oriDeg","style","transform","replace","parseInt","updateContent"],"mappings":"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","sourcesContent":["import React,{Component} from 'react';// 如果JSX 想要正常编译，必须用这个\nimport {connect} from 'react-redux';\nimport {Link} from 'react-router-dom';\nimport { CSSTransition } from 'react-transition-group';\nimport { actionCreator} from './store';\nimport {actionCreator as actionCreatorLogin} from '../../pages/login/store';\nimport {HeaderWrapper,\n        Logo, \n        Nav, \n        SearchInfo,\n        SearchInfoTitle,\n        SearchInfoUpdate,\n        SearchInfoItem,\n        SearchInfoList,\n        NavItem,\n        NavSearch,\n        Button,\n        SearchWrapper} from './style';\n        \n\n\nclass Header extends Component{\n  getSearchInfoList(){\n    //结构赋值语法\n    const {mouseIn,focused, list, page, totalPage, handleMouseEnter,handleMouseLeave, handleUpdateContent} = this.props;\n    //list 是immutable\n    const pageList = [];\n    const newList = list.toJS(); //把immutable 数组转成一个普通的js数组\n\n    //ajax请求，如果newList 里面有东西的时候，newList才能作为key 值来使用 刚开始如果不做循环，那么Key 值就不会有任何的问题\n    if(newList.length){\n      for(let i = (page - 1) * 10; i < page * 10; i++){\n        pageList.push(\n            <SearchInfoItem key = {newList[i]}> {newList[i]}\n          </SearchInfoItem>\n        )}\n      }\n    //在info 框里点击的时候也一样会显示\n    if(focused || mouseIn){\n      return(\n        <SearchInfo \n        onMouseEnter = {handleMouseEnter}\n        onMouseLeave = {handleMouseLeave}\n        >\n        <SearchInfoTitle>\n          Hot Search\n          <SearchInfoUpdate \n          onClick = {() => handleUpdateContent(page,totalPage, this.spinIcon)}> \n          <span ref = {(icon) => {this.spinIcon = icon}} \n          className =\"iconfont spin\">&#xe65e;</span>Update\n          </SearchInfoUpdate>\n        </SearchInfoTitle>\n        <SearchInfoList>\n          {/* {\n          list.map((item) => {\n            return <SearchInfoItem key = {item}> {item}\n            </SearchInfoItem>\n          })} */}\n          {pageList}\n        </SearchInfoList>\n      </SearchInfo>\n      )}else{\n      return null;\n    }\n  }\n\n  render(){\n    const {focused, handleInputFocus,handleInputBlur,list,login,logout} = this.props \n    return(\n          <HeaderWrapper>\n          <Link to = \"/\" className = \"logoWrap\">\n            <Logo/>\n          </Link>\n          <Nav>\n            <NavItem className = 'left active'>Home</NavItem>\n            <NavItem className = 'left'>Download App</NavItem>\n          \n            <SearchWrapper>\n              <CSSTransition\n                  //控制出场动画\n                  in = {focused}\n                  //动画时长\n                  timeout = {200}\n                  classNames = \"slide\"\n                >\n                <NavSearch \n                className = {focused ? 'focused' : ''}\n                onFocus = {() => handleInputFocus(list)}\n                onBlur = {handleInputBlur}> \n                </NavSearch>\n              </CSSTransition>\n                <span className = {focused ? 'focused iconfont zoom' : 'iconfont zoom'}>\n                    &#xe60c;</span>\n              {this.getSearchInfoList()}\n            </SearchWrapper>\n\n            <Link to = '/write'>\n            <Button className = 'reg'>\n              <span className =\"iconfont\">&#xe678;</span>\n              Add Article\n            </Button>\n            </Link>\n            <Link to =\"/register\">\n              <Button className = 'write'>Sign up</Button>\n            </Link>\n\n            {\n              login ? \n              <NavItem onClick = {logout} className = 'right'>Log out</NavItem> : \n              <Link to = \"/login\"><NavItem className = 'right'>Log in</NavItem></Link>\n            }\n\n            \n            <NavItem className = 'right'>\n                <span className =\"iconfont\">&#xe771;</span>\n            </NavItem>\n          </Nav>\n      </HeaderWrapper>\n   )\n  }\n}\n\n// Header 为statelss（无状态） 组件\n//好处：提高性能\n\n\n// 这个组件和store做连接的时候，store里的数据如何隐射到Props中去\n//state 指的是 store 里的所有数据\n//指的是仓库里的focused\n//加了header是因\b为放在了header里了。\n// getIn: 取header下面的focused 这个值\n// focused:state.get('header').get('focused') \nconst mapStateToProps = (state) => {\n  return {\n    focused: state.getIn(['header', 'focused']),\n    list:state.getIn(['header','list']),\n    page:state.getIn(['header','page']),\n    totalPage:state.getIn(['header','totalPage']),\n    mouseIn: state.getIn(['header','mouseIn']),\n    login: state.getIn(['login', 'login'])\n  }\n}\n\n//组件在和store做连接的时候，当组件想要改变store里的内容，就要调用store里的方法 “mapDispathToProps” 写在这个方法里\n// dispatch : store.dispatch\nconst mapDispathToProps = (dispatch) => {\n  return{\n    handleInputFocus(list){\n      (list.size === 0) && dispatch(actionCreator.getList());\n      //\n      // const action = actionCreator.searchFocus();\n      //size from console 上的list的属性\n      // console.log(list)\n      // if(list.size === 0){\n      //   dispathch(actionCreator.getList());\n      // }\n      dispatch(actionCreator.searchFocus());  \n    },\n    handleInputBlur(){\n      // const action = actionCreator.searchBlur()\n      dispatch(actionCreator.searchBlur())\n    },\n    handleMouseEnter(){\n      dispatch(actionCreator.mouseEnter())\n    },\n    handleMouseLeave(){\n      dispatch(actionCreator.mouseLeave())\n    },\n    handleUpdateContent(page, totalPage, spin){\n      let oriDeg = spin.style.transform.replace(/[^0-9]/ig, '');\n      //如果这里面的内容都不是0-9的数字，那就替换成空\n      // console.log(oriDeg);\n      if(oriDeg){\n        oriDeg = parseInt(oriDeg, 10); // 以10进制的方式转换为一个正整数 \n      }else{\n        oriDeg = 0; //第一次点击\n      }\n      spin.style.transform  = 'rotate(' + (oriDeg + 360) + 'deg)';\n      // spin.style.transform = 'rotate(' + (oriDeg + 360) + 'deg)';\n\n      if(page < totalPage){\n        dispatch(actionCreator.updateContent(page + 1))\n      }else{ \n        // 如果在最后一页面上了，再回到第一页面 if(page == totalPage)\n        dispatch(actionCreator.updateContent(1))\n      } \n      // console.log(page,totalPage)\n    },\n    logout(){\n      dispatch(actionCreatorLogin.logout())\n    }\n  }\n}\n\n\nexport default connect(mapStateToProps, mapDispathToProps ) (Header);"]},"metadata":{},"sourceType":"module"}